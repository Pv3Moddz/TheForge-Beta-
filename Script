local Player = game.Players.LocalPlayer
local Tween = game:GetService('TweenService')
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "The Forge Beta (༗ Pv3Moddz </>)",
    Icon = 0,
    LoadingTitle = "The Forge Beta",
    LoadingSubtitle = "by ༗ Pv3Moddz </>",
    ShowText = "༗ Pv3Moddz </>",
    Theme = "Amethyst",
    ToggleUIKeybind = "K",
    ConfigurationSaving = {
        Enabled = true,
        FileName = "Saves"
    },
})

local Teleporting = false


local MineFarmRunning = false
local MineFarmToggle = nil
local MineFarmDropdown = nil
local AreaMineFarmDropdown = nil
local MineFarmHeightSlider = nil

local MobFarmRunning = false
local MobFarmToggle = nil
local MobFarmDropdown = nil
local MobFarmForwardSlider = nil
local MobFarmRightSlider = nil
local MobFarmUpSlider = nil

local TeleportSpeedSlider = nil

local MainTab = Window:CreateTab("Main", 4483362458)

MainTab:CreateSection("Camera")
MainTab:CreateSlider({
    Name = "CameraMaxZoomDistance",
    Range = {50, 500},
    Increment = 1,
    Suffix = "cm",
    CurrentValue = 50,
    Flag = "CameraMaxZoomSlide",
    Callback = function(Value)
        Player.CameraMaxZoomDistance = Value
    end,
})
MainTab:CreateButton({
    Name = "Enable Invisicam",
    Callback = function()
        Player.DevCameraOcclusionMode = Enum.DevCameraOcclusionMode.Invisicam
    end,
})

MainTab:CreateSection("Close")
MainTab:CreateButton({
    Name = "Remove Script",
    Callback = function()
        Rayfield:Destroy()
    end,
})

local MinerFarmTab = Window:CreateTab(" Farm", 4483362458)
MinerFarmTab:CreateSection(" Mine")
MineFarmToggle = MinerFarmTab:CreateToggle({
    Name = "Enable MineFarm",
    CurrentValue = false,
    Flag = "MineFarmToggle",
    Callback = function(Value)
        MineFarmRunning = Value
        if Value and MineFarmDropdown and AreaMineFarmDropdown and MineFarmHeightSlider then
            task.spawn(function()
                while MineFarmRunning do
                    task.wait()
                    local HRP = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
                    if not HRP then continue end
                    local Target = nil
                    local LastDist = math.huge
                    for _, Area in ipairs(workspace.Rocks:GetChildren()) do
                        for _, AreaName in ipairs(AreaMineFarmDropdown.CurrentOption) do
                            if string.find(Area.Name, AreaName, 1, true) then
                                for _, SpawnLoc in ipairs(Area:GetChildren()) do
                                    for _, Item in ipairs(SpawnLoc:GetChildren()) do
                                        local DestPart = Item:FindFirstChild("Hitbox")
                                        local Health = Item:GetAttribute("Health")
                                        local MaxHealth = Item:GetAttribute("MaxHealth")
                                        local LastHitPlayer = Item:GetAttribute("LastHitPlayer")
                                        if DestPart and Health and MaxHealth and Health > 0 then
                                            if LastHitPlayer == Player.Name or Health == MaxHealth then
                                                for _, StoneName in ipairs(MineFarmDropdown.CurrentOption) do
                                                    if string.match(Item.Name, "^"..StoneName) then
                                                        local Dist = (DestPart.Position - HRP.Position).Magnitude
                                                        if Dist < LastDist then
                                                            LastDist = Dist
                                                            Target = Item
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    if Target then
                        local Destination = Target:FindFirstChild("Hitbox")
                        if Destination and TeleportSpeedSlider and MineFarmHeightSlider then
                            local TPTween = Tween:Create(HRP, TweenInfo.new((Destination.Position - HRP.Position).Magnitude / TeleportSpeedSlider.CurrentValue, Enum.EasingStyle.Linear), {CFrame = Destination.CFrame + Vector3.new(0,MineFarmHeightSlider.CurrentValue,0)})
                            TPTween:Play()
                            TPTween.Completed:Wait()
                            HRP.Anchored = true
                            local Continue = true
                            local CurrentHealth = Target:GetAttribute("Health")
                            while CurrentHealth and Target and CurrentHealth > 0 and MineFarmRunning and Continue do
                                CurrentHealth = Target:GetAttribute("Health")
                                game:GetService("ReplicatedStorage"):WaitForChild("Shared"):WaitForChild("Packages"):WaitForChild("Knit"):WaitForChild("Services"):WaitForChild("ToolService"):WaitForChild("RF"):WaitForChild("ToolActivated"):InvokeServer("Pickaxe")
                                local Named = false
                                for _, StoneName in ipairs(MineFarmDropdown.CurrentOption) do
                                    if string.match(Target.Name, "^"..StoneName) then
                                        Named = true
                                    end
                                end
                                local CurrentHRP = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
                                if Destination and CurrentHRP and (Destination.Position - CurrentHRP.Position).Magnitude > 10 then Continue = false end
                                if not Named then Continue = false end
                                task.wait(0.1)
                            end
                            HRP.Anchored = false
                            HRP.CFrame = Destination.CFrame + Vector3.new(0,10,0)
                        end
                    end
                end
            end)
        end
    end,
})
MineFarmDropdown = MinerFarmTab:CreateDropdown({
    Name = "Stone Type",
    Options = {"Pebble", "Rock", "Boulder", "Lucky Block", "Basalt Rock", "Basalt Core", "Basalt Vein", "Volcanic Rock", "Crimson Crystal", "Cyan Crystal", "Earth Crystal", "Light Crystal", "Violet Crystal"},
    CurrentOption = {"Pebble"},
    MultipleOptions = true,
    Flag = "MineFarmDropdown",
    Callback = function(Options)
    end,
})
AreaMineFarmDropdown = MinerFarmTab:CreateDropdown({
    Name = "Area Miner",
    Options = {"Island1CaveDeep", "Island1CaveMid", "Island1CaveStart", "Roof", "Island2CaveDanger1", "Island2CaveDanger2", "Island2CaveDanger3", "Island2CaveDanger4", "Island2CaveDangerClosed", "Island2CaveDeep", "Island2CaveLavaClosed", "Island2CaveMid", "Island2CaveStart", "Island2GoblinCave", "Island2VolcanicDepths"},
    CurrentOption = {"Island1CaveDeep"},
    MultipleOptions = true,
    Flag = "AreaMineFarmDropdown",
    Callback = function(Options)
    end,
})
MineFarmHeightSlider = MinerFarmTab:CreateSlider({
    Name = "Miner Height",
    Range = {-10, 10},
    Increment = 1,
    Suffix = "cm",
    CurrentValue = -7,
    Flag = "MineFarmHeightSlider",
    Callback = function(Value)
    end,
})

local MobFarmTab = Window:CreateTab("Mob Farm", 4483362458)
MobFarmTab:CreateSection("MobFarm")
MobFarmToggle = MobFarmTab:CreateToggle({
    Name = "Enable MobFarm",
    CurrentValue = false,
    Flag = "MobFarmToggle",
    Callback = function(Value)
        MobFarmRunning = Value
        if Value and MobFarmDropdown then
            task.spawn(function()
                while MobFarmRunning and MobFarmForwardSlider and MobFarmRightSlider and MobFarmUpSlider do
                    task.wait()
                    local HRP = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
                    if not HRP then continue end
                    local Target = nil
                    local LastDist = math.huge
                    for _, Living in ipairs(workspace.Living:GetChildren()) do
                        local IsNpc = Living:GetAttribute("IsNpc")
                        local NpcHRP = Living:FindFirstChild("HumanoidRootPart")
                        local NpcHumanoid = Living:FindFirstChild("Humanoid")
                        for _, MobName in ipairs(MobFarmDropdown.CurrentOption) do
                            if string.match(Living.Name, "^"..MobName) and IsNpc and IsNpc == true and NpcHRP and NpcHumanoid and NpcHumanoid.Health > 0 then
                                local Dist = (NpcHRP.Position - HRP.Position).Magnitude
                                if Dist < LastDist then
                                    LastDist = Dist
                                    Target = Living
                                end
                            end
                        end
                    end
                    if Target then
                        local Continue = true
                        local NpcHRP = Target:FindFirstChild("HumanoidRootPart")
                        local NpcHumanoid = Target:FindFirstChild("Humanoid")
                        while Target and Continue and MobFarmRunning do
                            if NpcHRP and NpcHumanoid and NpcHumanoid.Health > 0 and TeleportSpeedSlider then
                                HRP.Anchored = false
                                local TPTween = Tween:Create(HRP, TweenInfo.new((NpcHRP.Position - HRP.Position).Magnitude / TeleportSpeedSlider.CurrentValue, Enum.EasingStyle.Linear), {CFrame = NpcHRP.CFrame + (NpcHRP.CFrame.LookVector * MobFarmForwardSlider.CurrentValue) + (NpcHRP.CFrame.UpVector * MobFarmUpSlider.CurrentValue) + (NpcHRP.CFrame.RightVector * MobFarmRightSlider.CurrentValue)})
                                TPTween:Play()
                                TPTween.Completed:Wait()
                                HRP.Anchored = true
                                game:GetService("ReplicatedStorage"):WaitForChild("Shared"):WaitForChild("Packages"):WaitForChild("Knit"):WaitForChild("Services"):WaitForChild("ToolService"):WaitForChild("RF"):WaitForChild("ToolActivated"):InvokeServer("Weapon")
                                local CurrentHRP = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
                                if CurrentHRP and (NpcHRP.Position - CurrentHRP.Position).Magnitude > 10 then Continue = false end
                            else
                                Continue = false
                            end
                            task.wait(0.1)
                        end
                        HRP.Anchored = false
                        HRP.CFrame = NpcHRP.CFrame + Vector3.new(0,10,0)
                    end
                end
            end)
        end
    end,
})
MobFarmDropdown = MobFarmTab:CreateDropdown({
    Name = "MobSelect",
    Options = {"Zombie", "Delver Zombie", "Elite Zombie", "Brute Zombie", "Bomber", "Skeleton Rogue", "Axe Skeleton", "Deathaxe Skeleton", "Elite Rogue Skeleton", "Elite Deathaxe Skeleton", "Reaper", "Slime", "Blazing Slime"},
    CurrentOption = {"Zombie"},
    MultipleOptions = true,
    Flag = "MobFarmDropdown",
    Callback = function(Options)
    end,
})
MobFarmForwardSlider = MobFarmTab:CreateSlider({
    Name = "Forward OffSet",
    Range = {-10, 10},
    Increment = 1,
    Suffix = "cm",
    CurrentValue = -5,
    Flag = "MineFarmHeightSlider",
    Callback = function(Value)
    end,
})
MobFarmRightSlider = MobFarmTab:CreateSlider({
    Name = "Right Offset",
    Range = {-10, 10},
    Increment = 1,
    Suffix = "cm",
    CurrentValue = 0,
    Flag = "MineFarmHeightSlider",
    Callback = function(Value)
    end,
})
MobFarmUpSlider = MobFarmTab:CreateSlider({
    Name = "Up Offset",
    Range = {-10, 10},
    Increment = 1,
    Suffix = "cm",
    CurrentValue = 0,
    Flag = "MineFarmHeightSlider",
    Callback = function(Value)
    end,
})

local TeleportTab = Window:CreateTab("Teleport", 4483362458)
TeleportTab:CreateSection("TeleportSpeed")
TeleportSpeedSlider = TeleportTab:CreateSlider({
    Name = "Teleport Speed",
    Range = {30, 150},
    Increment = 1,
    Suffix = "x",
    CurrentValue = 60,
    Flag = "MineFarmHeightSlider",
    Callback = function(Value)
    end,
})
TeleportTab:CreateSection("Teleport Shops")
TeleportTab:CreateButton({
    Name = "Forging Station",
    Callback = function()
        local Pos = Vector3.new(-193, 30, 160)
        local HRP = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
        if HRP and TeleportSpeedSlider then
            local TPTween = Tween:Create(HRP, TweenInfo.new((Pos - HRP.Position).Magnitude / TeleportSpeedSlider.CurrentValue, Enum.EasingStyle.Linear), {CFrame = CFrame.new(Pos)})
            TPTween:Play()
            TPTween.Completed:Wait()
        end
    end,
})

Rayfield:SetVisibility(true)
